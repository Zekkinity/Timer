<!DOCTYPE html>
<html>
<head>
  <title>Timer Queue</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    #timers { margin-top: 20px; }
    .timer-box { padding: 10px; border: 1px solid black; margin-bottom: 10px; }
  </style>
</head>
<body>

<h1>Timer Queue</h1>

<input id="duration" type="number" placeholder="Seconds" />
<button onclick="addTimer()">Add Timer</button>
<button onclick="pauseTimer()">Pause</button>
<button onclick="resumeTimer()">Resume</button>
<button id="repeatBtn" onClick="toggleRepeat()">Repeat OFF</button>

<div id="timers"></div>
<h2 id="current"></h2>

<script>
let queue = [];      // holds durations
let current = null;  // currently active timer
let remaining = 0;   // seconds left
let interval = null; // interval ID
let paused = false;
let repeat = false;

function addTimer() {
    const sec = parseInt(document.getElementById("duration").value);
    if (!sec || sec <= 0) return;

    queue.push(sec);
    // Clear input
    document.getElementById("duration").value = "";
    renderQueue();

    if (!current) startNextTimer();
}

function startNextTimer() {
    if (queue.length === 0) {
        current = null;
        document.getElementById("current").innerText = "No timers left";
        return;
    }

    current = queue.shift();
    remaining = current;

    document.getElementById("current").innerText = "Timer Started: " + remaining + "s";

    renderQueue();
    startInterval();
}

function startInterval() {
    clearInterval(interval);

    interval = setInterval(() => {
        if (paused) return;

        remaining--;

        document.getElementById("current").innerText =
            "Current Timer: " + remaining + "s";

        // Repeat feature
        if (remaining <= 0 && repeat) {
            remaining = current;
            document.getElementById("current").innerText =
            "Repeating Timer: " + remaining + "s";
            return
        }

        if (remaining <= 0) {
            clearInterval(interval);
            alert("Timer expired!");
            startNextTimer();
        }
    }, 1000);
}

function pauseTimer() {
    paused = true;
}

function resumeTimer() {
    paused = false;
}

function toggleRepeat() {
    repeat = !repeat;

    const btn = document.getElementById("repeatBtn");
    if (repeat) {
        btn.innerText = "Repeat ON";
        btn.classList.add("active");
    } else {
        btn.innerText = "Repeat OFF";
        btn.classList.remove("active");
    }
}

function renderQueue() {
    let html = "";

    // Display newest timer at bottom without modifying actual queue
    queue.slice().forEach((t, i) => {
        html += `<div class="timer-box">Timer ${i + 1}: ${t}s</div>`;
    });

    document.getElementById("timers").innerHTML = html;
}
</script>

</body>
</html>

